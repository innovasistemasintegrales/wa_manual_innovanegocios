var app=angular.module("newsApp",["ui.router","ng.post","news.controller","news.service","news.directive"]);app.config(["$stateProvider","$urlRouterProvider",function(e,n){e.state("index",{url:"/index",templateUrl:"template/index.html",controller:"indexCtrl"}).state("index.list",{url:"/list",templateUrl:"template/newsList.html",controller:"listCtrl"}).state("index.secondlist",{url:"/secondlist",templateUrl:"template/secondList.html",controller:"secondListCtrl"}).state("index.thirdlist",{url:"/thirdlist",templateUrl:"template/thirdList.html",controller:"thirdListCtrl"}).state("detail",{url:"/detail/:channelId/:id",templateUrl:"template/detail.html",controller:"detailCtrl"}).state("login",{url:"/login",templateUrl:"template/logins.html",controller:"loginsCtrl"}).state("register",{url:"/register",templateUrl:"template/register.html",controller:"registerCtrl"}).state("setting",{url:"/setting",templateUrl:"template/setting.html",controller:"settingCtrl"}),n.when("","/index/list")}]),app.value("apiUrl","http://localhost:12345/newsApi"),app.value("apiMethod","get");var news=json;console.log(news),function(){var e=angular.module("news.controller",[]);e.controller("indexCtrl",["$scope","$rootScope","$http","cookie","$window",function(e,n,o,t,i){var s=t.getCookie("token"),a=t.getCookie("username");o.post("http://localhost:81/angular/news/index.php/login_api/auto_login",{params:{token:s,username:a}}).success(function(e){console.log(e),e.code||(window.location.href="#/login")}),e.tabs=[{name:"国内最新",id:1,url:"#/index/list"},{name:"国际焦点",id:2,url:"#/index/secondlist"},{name:"游戏焦点",id:3,url:"#/index/thirdlist"},{name:"登录",id:4,url:"#/login"}],n.id=1,e.toggleTab=function(e,o){console.log(e),n.id=e,i.location.href=o}}]),e.controller("listCtrl",["$scope","$http","swiperImg","apiUrl",function(e,n,o,t){e.isShowSwiper=!0,e.page=1,e.isShow=!1,e.sortList=!1,e.type="pubDate",e.channelId="5572a109b3cdc86cf39001db",e.news=[],e.swiperImg=[];var i=function(){n.jsonp(t,{params:{page:e.page,channelId:"5572a109b3cdc86cf39001db",channelName:"国内最新",callback:"JSON_CALLBACK"}}).success(function(n){n=json,e.isShow=!0,console.log(n),e.news=e.news.concat(n.showapi_res_body.pagebean.contentlist),e.swiperImg=o.get(e.news)})};i(),e.searchName="",e.isSearch=!1,e.search=function(){e.isSearch=!0},e.cancelSearch=function(){e.isSearch=!1},e.loadMore=function(){e.isShow=!1,e.page++,i()}}]),e.controller("thirdListCtrl",["$scope","$http","$rootScope","swiperImg","apiUrl","apiMethod",function(e,n,o,t,i,s){e.isShowSwiper=!0,o.id=3,e.page=1,e.isShow=!1,e.channelId="5572a108b3cdc86cf39001d6",e.swiperImg=[],e.news=[];var a=function(){n.jsonp(i,{params:{page:e.page,channelId:"5572a108b3cdc86cf39001d6",channelName:"游戏焦点",callback:"JSON_CALLBACK"}}).success(function(n){n=json,e.isShow=!0,console.log(n),e.news=e.news.concat(n.showapi_res_body.pagebean.contentlist),e.swiperImg=t.get(e.news)})};a(),e.searchName="",e.isSearch=!1,e.search=function(){e.isSearch=!0},e.cancelSearch=function(){e.isSearch=!1},e.loadMore=function(){e.isShow=!1,e.page++,a()}}]),e.controller("secondListCtrl",["$scope","$http","$rootScope","swiperImg","apiUrl",function(e,n,o,t,i){e.isShowSwiper=!0,o.id=2,e.page=1,e.isShow=!1,e.channelId="5572a108b3cdc86cf39001ce",e.swiperImg=[],e.news=[];var s=function(){n.jsonp(i,{params:{page:e.page,channelId:"5572a108b3cdc86cf39001ce",channelName:"游戏焦点",callback:"JSON_CALLBACK"}}).success(function(n){n=json,e.isShow=!0,console.log(n),e.news=e.news.concat(n.showapi_res_body.pagebean.contentlist),e.swiperImg=t.get(e.news)})};s(),e.searchName="",e.isSearch=!1,e.search=function(){e.isSearch=!0},e.cancelSearch=function(){e.isSearch=!1},e.loadMore=function(){e.isShow=!1,e.page++,s()}}]),e.controller("detailCtrl",["$scope","$http","$state","apiUrl",function(e,n,o,t){e.isShowGallery=!1,e.id=parseInt(o.params.id),e.channelId=o.params.channelId,e.isShow=!1,e.showGallery=function(n,o){e.isShowGallery=n,console.log(o),e.imgUrl="background-image:url("+o+")"},console.log(o.params),n.jsonp(t,{params:{page:1,channelId:e.channelId,channelName:"",callback:"JSON_CALLBACK"}}).success(function(n){n=json,console.log(n),e.isShow=!0,e.allNum=n.showapi_res_body.pagebean.allNum,e.new=n.showapi_res_body.pagebean.contentlist[o.params.id],console.log(e.new)})}]),e.controller("loginsCtrl",["$scope","$http","cookie",function(e,n,o){e.page1=!0,e.page2=!1,e.show=function(n){1==n?(e.page1=!0,e.page2=!1):2==n&&(e.page2=!0,e.page1=!1)},e.login=function(){console.log("username:"+e.username),console.log("password:"+e.password),n.post("http://localhost:81/angular/news/index.php/login_api/login",{params:{username:e.username,password:e.password}}).success(function(e){console.log(e),e.code&&(o.setCookie("token",e.info.token),o.setCookie("username",e.username),window.location.href="#/index/list")})}}]),e.controller("registerCtrl",["$scope","$http","cookie",function(e,n,o){e.register=function(){console.log("username:"+e.username),console.log("password:"+e.password),n.post("http://localhost:81/angular/news/index.php/login_api/register",{params:{username:e.username,password:e.password}}).success(function(e){console.log(e),e.code&&(o.setCookie("username",e.username),o.setCookie("token",e.info.token),window.location.href="#/index/list")})}}]),e.controller("settingCtrl",["$scope","$http","cookie",function(e,n,o){var t=o.getCookie("token"),i=o.getCookie("username");n.post("http://localhost:81/angular/news/index.php/login_api/auto_login",{params:{token:t,username:i}}).success(function(e){console.log(e),e.code||(window.location.href="#/login")})}])}(),function(){var e=angular.module("news.service",[]);e.service("cookie",["$document",function(e){return{setCookie:function(n,o){var t=10,i=new Date;i.setTime(i.getTime()+24*t*60*60*1e3),e[0].cookie=n+"="+o+";expires="+i},getCookie:function(n){var o,t=new RegExp("(^|)"+n+"=([^;]*)(;|$)");if(o=e[0].cookie.match(t))return o[2]}}}]),e.service("swiperImg",[function(){return{get:function(e,n){n||(n=2);var o=[];return angular.forEach(e,function(e,t){e.havePic&&o.length<=n&&(e.id=t,o.push(e))}),o}}}])}(),function(){var e=angular.module("news.directive",[]);e.directive("newsList",[function(){return{templateUrl:"directive/newsList.html"}}]),e.directive("searchBar",[function(){return{templateUrl:"directive/searchBar.html"}}]),e.directive("swiper",[function(){return{templateUrl:"directive/swiper.html",link:function(e,n,o){new Swiper(".swiper-container",{pagination:".swiper-pagination",paginationClickable:!0})}}}]),e.directive("loading",[function(){return{templateUrl:"directive/loading.html"}}])}();